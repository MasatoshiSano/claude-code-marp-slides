# Claude Codeカスタムコマンド活用術

## 開発効率を劇的に向上させる実践ガイド

### 目次

1. カスタムコマンドとは何か？
2. 基本的な設定方法
3. おすすめカスタムコマンド5選
4. 高度な機能活用
5. チーム活用のベストプラクティス
6. よくある失敗パターン
7. まとめと次のステップ

### このスライドで話すこと・話さないこと

#### 話すこと
- カスタムコマンドの具体的な作成・活用方法
- 実際の開発現場で使えるコマンド例
- チームでの共有・標準化手法
- 効率化の実測効果と事例

#### 話さないこと
- Claude Code基本機能の詳細説明
- 他のAIツールとの比較
- 料金・ライセンスに関する情報
- 技術的なトラブルシューティング詳細

## カスタムコマンドとは何か？

### 定義と基本概念
Claude Codeのカスタムスラッシュコマンド機能は、**頻繁に使用するプロンプトをMarkdownファイルとして定義し、ワンコマンドで実行できる**強力な機能です。

### なぜカスタムコマンドが重要なのか？

#### 問題：プロンプトの品質バラツキ
- 毎回微妙に違うプロンプトを入力
- AIの挙動が不安定になる
- チームメンバー間での作業方法の違い
- 複雑な指示の記憶負担

#### 解決：標準化による一貫性
- **同じプロンプトで安定した結果**
- **チームルールのコマンド化**
- **新人でもベテランと同じ品質**
- **複雑な作業フローを1コマンドで実行**

### 主な利点
1. **効率化**: よく使う作業を瞬時に実行
2. **標準化**: チーム全体で統一された手法
3. **品質向上**: 一貫した高品質な結果
4. **知識共有**: ベストプラクティスのコマンド化

## 基本的な設定方法

### 2つのスコープ

#### 1. プロジェクト固有コマンド（推奨）
- **保存場所**: `.claude/commands/`
- **用途**: プロジェクト固有の作業
- **共有**: チームメンバーと共有可能
- **バージョン管理**: Gitで管理できる

#### 2. 個人用コマンド
- **保存場所**: `~/.claude/commands/`
- **用途**: 個人的な作業パターン
- **共有**: 個人環境でのみ利用
- **汎用性**: 全プロジェクトで利用可能

### ファイル作成の基本ステップ

#### ステップ1: ディレクトリ作成
```bash
mkdir -p .claude/commands
```

#### ステップ2: コマンドファイル作成
```bash
# 例：テスト実行コマンド
touch .claude/commands/test-all.md
```

#### ステップ3: プロンプト記述
```markdown
# .claude/commands/test-all.md
すべてのテストを実行し、結果をわかりやすく表示してください。
失敗したテストがあれば、原因と修正方法を提案してください。
```

### 呼び出し方法の進化

#### v1.0.25以降（推奨）
```
/test-all
```

#### 従来の方法（互換性あり）
```
/project:test-all
/user:test-all
```

## おすすめカスタムコマンド5選

### 1. テスト＆コミット自動化

#### コマンド名: `test-and-commit`
#### 機能: テスト実行→Lintチェック→コミットの一連フロー

```markdown
# .claude/commands/test-and-commit.md
以下の手順でコードの品質チェックとコミットを行ってください：

1. 全てのテストを実行し、結果を確認
2. Lintチェックを実行し、問題があれば修正提案
3. 問題がなければ適切なコミットメッセージを生成
4. コミット実行の準備ができた旨を報告

テストやLintで問題が見つかった場合は、修正方法を具体的に提案してください。
```

#### 使用場面
- 機能実装完了時
- プルリクエスト作成前
- 定期的な品質チェック

#### 効果測定
- **従来**: 5-10分の手動チェック
- **コマンド後**: 1分で完了
- **品質向上**: 見落としリスク80%削減

### 2. セキュリティレビュー

#### コマンド名: `security-review`
#### 機能: セキュリティ観点での包括的コードレビュー

```markdown
# .claude/commands/security-review.md
以下の観点でセキュリティレビューを実施してください：

## チェック項目
1. **入力検証**
   - SQLインジェクション対策
   - XSS脆弱性の確認
   - CSRFトークンの実装

2. **認証・認可**
   - 適切な権限制御
   - セッション管理の安全性
   - パスワードハッシュ化

3. **データ保護**
   - 機密データの暗号化
   - ログ出力での情報漏洩防止
   - APIキーの適切な管理

4. **設定・デプロイ**
   - セキュアなHTTPSヘッダー
   - 不要なサービス・ポートの無効化
   - エラーメッセージでの情報漏洩防止

各項目について、リスクレベル（高・中・低）と具体的な改善提案を提示してください。
```

#### 適用範囲
- 新機能実装時
- 定期的なセキュリティ監査
- 外部公開前の最終チェック

### 3. ドキュメント自動生成

#### コマンド名: `doc-generator`
#### 機能: コードベースからプロジェクト仕様書を生成

```markdown
# .claude/commands/doc-generator.md
プロジェクトのコードベースを分析し、以下の構成で技術仕様書を生成してください：

## 生成する文書構成
1. **プロジェクト概要**
   - 目的と機能
   - 主要な技術スタック
   - アーキテクチャ概要

2. **API仕様**
   - エンドポイント一覧
   - リクエスト/レスポンス形式
   - 認証方法

3. **データベース設計**
   - テーブル構造
   - リレーション図
   - インデックス戦略

4. **セットアップ手順**
   - 環境構築方法
   - 依存関係のインストール
   - 初期設定手順

5. **運用・保守**
   - ログ監視ポイント
   - バックアップ戦略
   - トラブルシューティング

マークダウン形式で出力し、図表が必要な部分は明示してください。
```

### 4. コード最適化レビュー

#### コマンド名: `optimize-code`
#### 機能: パフォーマンスと保守性の観点から最適化提案

```markdown
# .claude/commands/optimize-code.md
コードの最適化レビューを以下の観点から実施してください：

## パフォーマンス最適化
1. **アルゴリズム効率性**
   - 時間計算量の分析
   - 空間計算量の確認
   - より効率的なアルゴリズムの提案

2. **データベース最適化**
   - クエリの実行計画確認
   - インデックス活用の提案
   - N+1問題の検出

3. **メモリ使用量**
   - メモリリークの可能性
   - 不要なオブジェクト生成の削減
   - キャッシュ戦略の提案

## 保守性向上
1. **コード可読性**
   - 命名規則の改善
   - 複雑な処理の分割提案
   - コメントの追加・改善

2. **設計改善**
   - SOLID原則の適用
   - デザインパターンの活用
   - 依存関係の整理

具体的な改善コードと期待される効果を示してください。
```

### 5. Marpスライド生成

#### コマンド名: `create-marp-slide`
#### 機能: トピックからMarp形式のプレゼンテーション生成

```markdown
# .claude/commands/create-marp-slide.md
指定されたトピック「$ARGUMENTS」について、Marp形式のプレゼンテーションスライドを作成してください。

## 生成要件
1. **構成**
   - タイトルスライド
   - 目次
   - 話すこと・話さないこと
   - 本編（8-12スライド）
   - まとめ

2. **スタイル**
   - 見やすいレイアウト
   - 適切な画像の提案
   - 箇条書きを効果的に活用

3. **内容**
   - 実践的で具体的な情報
   - 図表の活用提案
   - アクションアイテムの明示

Marpのフロントマターも含めて完全なMarkdownファイルとして出力してください。
```

#### 使用例
```
/create-marp-slide プロジェクト管理効率化
```

## 高度な機能活用

### 引数（Arguments）の活用

#### 基本構文
```markdown
# コマンドファイル内
指定されたファイル「$ARGUMENTS」をレビューしてください。
```

#### 使用例
```
/code-review src/utils/validator.js
```

#### 複数引数の処理
```markdown
# 引数を空白で分割して処理
バグ番号 $1 について、優先度 $2 で修正作業を開始してください。
```

### ファイル参照（@プレフィックス）

#### 基本使用法
```markdown
@README.md の内容を参考に、プロジェクトの概要説明を作成してください。
```

#### 複数ファイル参照
```markdown
@package.json と @README.md を確認し、依存関係の更新提案を行ってください。
```

#### 設定ファイルとの連携
```markdown
@.eslintrc.json の設定に基づいて、コードスタイルの問題を特定してください。
```

### Bashコマンド統合（!プレフィックス）

#### システム情報取得
```markdown
# .claude/commands/system-info.md
以下のシステム情報を取得して分析してください：

!uname -a
!node --version
!npm --version

現在の環境でのプロジェクト実行に問題がないか確認してください。
```

#### 自動テスト実行
```markdown
# .claude/commands/run-tests.md
!npm test

テスト結果を分析し、失敗している項目があれば原因と修正方法を提案してください。
```

### YAMLフロントマターの活用

#### メタデータの記述
```markdown
---
title: "セキュリティレビューコマンド"
description: "包括的なセキュリティチェック"
version: "1.2"
author: "開発チーム"
last_updated: "2025-01-15"
---

# セキュリティレビューの実施

このコマンドは以下の項目をチェックします...
```

#### 条件分岐の実装
```markdown
---
requires_confirmation: true
estimated_time: "5-10分"
---

この処理は時間がかかる可能性があります。続行しますか？
```

## チーム活用のベストプラクティス

### プロジェクト共有の設定

#### 1. チーム標準コマンドの作成
```
.claude/commands/
├── team/
│   ├── code-review.md
│   ├── deploy-check.md
│   └── security-scan.md
├── project/
│   ├── build-release.md
│   └── update-docs.md
└── README.md  # コマンド使用ガイド
```

#### 2. コマンド使用ガイドの作成
```markdown
# .claude/commands/README.md
## チーム共有コマンド一覧

### 開発フロー
- `/code-review` - コードレビュー実施
- `/test-and-commit` - テスト＆コミット
- `/deploy-check` - デプロイ前チェック

### 品質管理
- `/security-scan` - セキュリティスキャン
- `/performance-check` - パフォーマンス分析
- `/doc-update` - ドキュメント更新

## 使用方法
各コマンドは引数を受け取ります：
`/code-review src/components/Header.jsx`
```

### バージョン管理との連携

#### .gitignoreの設定
```
# ユーザー固有のコマンドは除外
.claude/commands/personal/
.claude/commands/local-*
```

#### チーム共有コマンドの管理
```
# チーム標準コマンドはコミット対象
.claude/commands/team/
.claude/commands/project/
.claude/commands/README.md
```

### 権限とセキュリティ管理

#### 機密情報の取り扱い
```markdown
# 悪い例：機密情報をコマンドに埋め込み
API_KEY="sk-xxx" でテストを実行してください

# 良い例：環境変数参照
環境変数 API_KEY を使用してテストを実行してください
```

#### 危険なコマンドの制限
```markdown
# 危険な操作には確認プロセスを組み込み
---
requires_confirmation: true
danger_level: high
---

この操作は本番環境に影響する可能性があります。
実行前に以下を確認してください：
1. バックアップの取得
2. メンテナンス時間の確保
3. ロールバック手順の準備
```

## よくある失敗パターン

### 失敗パターン1: コマンドの過度な汎用化

#### 問題のあるコマンド
```markdown
# 抽象的すぎるコマンド
コードを改善してください。
```

#### 改善されたコマンド
```markdown
# 具体的で実行可能なコマンド
以下の観点でコードレビューを実施してください：
1. エラーハンドリングの実装
2. 変数名の明確性
3. 関数の単一責任原則遵守
4. テストカバレッジの確認

各項目について具体的な改善提案を提示してください。
```

### 失敗パターン2: 引数の不適切な使用

#### 問題のある使用
```markdown
# 検証なしの引数使用
$ARGUMENTS のファイルを削除してください。
```

#### 安全な使用方法
```markdown
# 安全性チェック付き
ファイル「$ARGUMENTS」について：
1. まず存在確認を行う
2. 削除前にバックアップの必要性を確認
3. 依存関係がないかチェック
4. 安全と判断された場合のみ削除を提案
```

### 失敗パターン3: メンテナンス不足

#### 問題
- 古い技術スタックに基づくコマンド
- チーム離脱者のパーソナルコマンド残存
- 使われなくなったコマンドの放置

#### 改善策
```markdown
# .claude/commands/maintenance.md
---
last_reviewed: "2025-01-15"
review_cycle: "quarterly"
---

定期的なコマンドメンテナンスを実施：

1. 使用頻度の低いコマンド特定
2. 技術スタック変更に伴う更新
3. 新チームメンバーのフィードバック反映
4. セキュリティガイドラインとの整合性確認
```

## 導入ステップと実践ガイド

### Phase 1: 個人利用での効果検証（1週間）

#### 導入すべき基本コマンド
1. `test-all` - テスト実行の標準化
2. `code-review` - 個人コードレビュー
3. `commit-helper` - コミットメッセージ生成

#### 効果測定方法
- 作業時間の記録（導入前後）
- コマンド使用頻度の追跡
- コード品質メトリクスの比較

### Phase 2: チーム試用（2-3週間）

#### チーム標準コマンドの作成
```
.claude/commands/team/
├── pull-request-review.md
├── security-checklist.md
└── deployment-checklist.md
```

#### 導入プロセス
1. **キックオフ会議**: 目的と期待効果の共有
2. **ハンズオン研修**: 実際のプロジェクトでの使用体験
3. **フィードバック収集**: 使いにくい点の改善
4. **ベストプラクティス共有**: 効果的な使用方法の標準化

### Phase 3: 全社展開（1ヶ月）

#### 組織レベルでの標準化
```
~/.claude/commands/company/
├── onboarding/
├── security/
└── documentation/
```

#### 継続的改善プロセス
1. **月次レビュー**: コマンド使用状況の分析
2. **四半期更新**: 新技術・ツールへの対応
3. **年次監査**: セキュリティ・品質基準の見直し

### 成功指標（KPI）

#### 定量的指標
- **開発速度**: タスク完了時間30%短縮
- **品質向上**: バグ発生率20%削減
- **標準化**: チーム内作業方法統一率90%
- **学習効果**: 新人立ち上がり時間50%短縮

#### 定性的指標
- **満足度**: 開発者エクスペリエンスの向上
- **一貫性**: プロジェクト間での作業品質統一
- **知識共有**: ベテランノウハウの組織資産化
- **モチベーション**: 単調作業からの解放

## まとめと次のステップ

### カスタムコマンドの価値再確認

Claude Codeのカスタムコマンド機能は、単なる効率化ツールを超えて、**チーム全体の開発品質とプロセスを標準化する強力な仕組み**です。

#### 主要なメリット
1. **即効性**: 導入初日から効果実感
2. **スケーラビリティ**: 個人からチーム、組織まで適用可能
3. **柔軟性**: プロジェクト特性に合わせたカスタマイズ
4. **継続性**: 一度作成すれば長期間利用可能

### 導入後の発展的活用

#### 1. AIと人間の協調パターンの確立
- コマンドによる標準化 + 人間の判断による最適化
- 定型作業の自動化 + 創造的作業への集中
- 品質チェックの機械化 + 戦略的判断の人間化

#### 2. 組織学習の促進
- ベストプラクティスのコマンド化による知識蓄積
- 失敗パターンの予防策組み込み
- 継続的改善サイクルの確立

#### 3. 開発文化の変革
- 品質第一の文化定着
- 効率性と生産性の両立
- チーム協調の自然な促進

### 次のアクションプラン

#### すぐに始められること
1. **今日**: 最初のカスタムコマンドを1つ作成
2. **今週**: 3つの基本コマンドで効果測定開始
3. **来月**: チームメンバーとコマンド共有

#### 中長期的な展開
1. **3ヶ月**: プロジェクト標準コマンドセット完成
2. **6ヶ月**: 組織横断でのベストプラクティス確立
3. **1年**: AI協調開発文化の組織浸透

### 最後のメッセージ

**カスタムコマンドは、AIと人間がより良く協調して価値を創出するための橋渡し役**です。単なる効率化を超えて、より創造的で価値の高い仕事にフォーカスできる環境づくりの第一歩として、ぜひ今日から活用を開始してください。

**小さく始めて、継続的に改善し、チーム全体で価値を最大化する**—これがカスタムコマンド成功の鍵です。